# Conditional Latent Diffusion for Temporal Brain Data Synthesis

## Problem setting

The EEG (Electroencephalography) measures the micro-potential differences between electrodes placed on the scalp, recording the brain activity of different areas of the outer cortices. The result is a time series with a certain sampling rate and a number of channels that corresponds to the number of electrodes placed on the scalp.

We want to design a model that generates EEG samples that mimic real EEG recordings of human subjects. The generated EEGs should be able to mimic recordings of "normal" brain activity as well as brain activity of subjects during epileptic seizures.

We denote the EEG data as a time series $X = \{X_1, X_2, ..., X_n\}$ where $X_t ∈ \mathbb{R}$ and $n = T * fs$, where $T$ is the recording duration and $fs$ the sampling rate of the recording. The data is labeled with $Y ∈ \{0, 1\}$ corresponding to two classes, healthy ($Y = 0$) and seizure activity ($Y = 1$).

We aim to design a model $f$ that learns the distribution of $X$ conditioned on $Y$. The goal of $f$ is to generate similar but new EEG time series $\hat{X}$ given a condition $Y$ and a latent vector $\hat{Z}$.


## Approach

Our approach uses a diffusion model to learn the conditional probability distribution $p(X | Y, \hat{Z})$. Training the model $f$ requires an additional model $g$, that converts a time series $X$ into a latent representation $\hat{Z}$. This latent vector $\hat{Z}$ is then used as an input to the model $f$ together with the condition $Y$. The model $g$ consists of an encoder that converts $X$ into a latent space $Z$, followed by a diffusion process that converts $Z$ into the latent representation $\hat{Z}$.

At generation time, given a label $Y$ and a latent vector $\hat{Z}$, the model uses the distribution $p(X | Y, \hat{Z})$ to synthesize $\hat{X}$.

The model will be trained on the TUH EEG Seizure Corpus [9]. It contains 6688 sessions of seizures from 1872 patients from over 20 years of recording. A majority of the EEG data was sampled at 250Hz (87%) with the remaining data being sampled at 256Hz (8.3%), 400Hz (3.8%), and 512Hz (1%).


## Evaluating model performance

To evaluate model performance we need another model $h$, that takes a time series $X$ as input and has $Y \in \{0, 1\}$ as output. The output $Y$ classifies the inputs as belonging to the classes healthy ($Y = 0$) or seizure activity ($Y = 1$).

Using the model $h$, the performance of $f$ (or of any model that generates EEGs) is determined as follows:

1. Initialize $h$ with random weights
2. Generate a set of pairs $T = \{(EEG_1, Y_1), (EEG_2, Y_2), …\}$ using $f$. Use random values for the latent input $\hat{Z}$ and the condition $Y$
3. Train $h$ using $T$ (supervised)
4. Use the trained model $h$ to predict the class of real EEGs from the dataset
5. Calculate the accuracy of the models predictions
6. $accuracy(h) \mathrel{\widehat{=}} performance(f)$ 

The performance of the EEG generator $f$ corresponds to the accuracy that a classifier $h$ has when classifying real EEGs, if the classifier $h$ has solely been trained using data generated by $f$.

Note that this only works, if the architecture of $h$ is suitable to classify EEGs. This can be ensured by supervised training of $h$ using real EEGs and reaching a satisfying accuracy.
